<style>


</style>


<div id="flat-slider"></div>
<div class="vertical">

    <div id="flat-slider-vertical-1"></div>
    <div id="flat-slider-vertical-2"></div>
    <div id="flat-slider-vertical-3"></div>

</div>


<h6><b>MODULACIÓN POR DESPLAZAMIENTO DE FASE ASK</b></h6>
<form class="form-panel">
    <div class="row">
        <div class=" col-sm-1">
            <label for="amp_ask_p">Ec:</label>
            <input type="number" id="amp_ask_p" value="1" step="1" min="1" max="50" class="validate form-control "
                   data-validate="required"/>
        </div>
        <div class="col-sm-1">
            <label for="freq_ask">fc:</label>
            <input type="number" id="freq_ask" value="10" step="1" min="1" max="50" class="validate form-control"
                   data-validate="required"/>
        </div>
        <div class="col-sm-1">
            <label for="amp_ask_m">Em:</label>
            <input type="number" id="amp_ask_m" value="5" step="1" min="1" max="50" class="validate form-control"
                   data-validate="required"/>
        </div>
        <div class="col-sm-1">
            <label for="freq_ask_m">fb:</label>
            <input type="number" id="freq_ask_m" value="2" step="1" min="1" max="50" class="validate form-control"
                   data-validate="required"/>

        </div>
        <div class="col-sm-1">
            <label for="askRedraw">Regrescar</label>
            <button type="button" id="askRedraw" class="btn btn-primary  ">
                <span class="btn-label"><i id="askRedrawIcon" class="glyphicon glyphicon-refresh"></i></span></button>
        </div>
    </div>
</form>


<div class='row trunk-section'>
    <div class='col-lg-10' id='ask_moduladora'/>
    <div class="col-lg-2">
        <span>
          <h5>Moduladora</h5>
               <h6 class="text-justify">
                   Forma de modulación digital que consiste en cambiar la amplitud de una onda portadora (una sinusoide) entre dos valores posibles.
               </h6>
        </span>
    </div>
</div>

<div class='row trunk-section'>
    <div class='col-lg-10 ' id='ask_portadora'/>
    <div class="col-lg-2">
         <span>
          <h5>Portadora</h5>
               <h6 class="text-justify">
                   Forma de modulación digital que consiste en cambiar la amplitud de una onda portadora (una sinusoide) entre dos valores posibles.
               </h6>
        </span>
    </div>
</div>

<div class='row trunk-section'>
    <div class='col-lg-10' id='ask_moduladaASK'/>
    <div class="col-lg-2">
         <span>
          <h5>Modulada</h5>
               <h6 class="text-justify">
                   Forma de modulación digital que consiste en cambiar la amplitud de una onda portadora (una sinusoide) entre dos valores posibles.
               </h6>
        </span>
    </div>
</div>
<div class='row trunk-section'>
    <div class='col-lg-10' id='ask_moduladaASKMix'/>
    <div class="col-lg-2">
        <span>
          <h5>Portadora/Moduladora</h5>
               <h6 class="text-justify">
                   Forma de modulación digital que consiste en cambiar la amplitud de una onda portadora (una sinusoide) entre dos valores posibles.
               </h6>
        </span>
        <h6 class='text-center' id="legendMix"/>
    </div>


</div>
<script>
    'use strict';


    var dwASKEnd = 0;

    function completo() {
        if (dwASKEnd = 4) {
            //Completo Imagen
            dismiss();
            $("#askRedrawIcon").removeClass().addClass('glyphicon glyphicon-refresh');
        }
    }

    var dwModuladoraASK = {
        custom_line_color_map: [9],
        inflator: 1.3,
        missing_is_hidden: true,
        point_size: 4.5,
        active_point_on_lines: true,
        top: 10,
        active_point_size: 10,
        width: 960,
        height: 150,
        right: 1,
        target: '#ask_moduladora',
        x_accessor: 'Tiempo',
        y_accessor: 'Moduladora',
        x_label: 'Tiempo',
        y_label: 'Moduladora',
        y_extended_ticks: true,
        x_extended_ticks: true,
        animate_on_load: true,
        area: false
    };

    var dwPortadoraASK = {
        custom_line_color_map: [8],
        inflator: 1.6,
        missing_is_hidden: true,
        point_size: 4.5,
        active_point_on_lines: true,
        top: 10,
        active_point_size: 10,
        width: 960,
        height: 150,
        right: 1,
        target: '#ask_portadora',
        x_accessor: 'Tiempo',
        y_accessor: 'Portadora',
        x_label: 'Tiempo',
        y_label: 'Portadora',
        y_extended_ticks: true,
        x_extended_ticks: true,
        animate_on_load: true,
        area: false
    };


    var dwModuladaASK = {
        custom_line_color_map: [3],
        inflator: 1.6,
        missing_is_hidden: true,
        point_size: 4.5,
        active_point_on_lines: true,
        top: 10,
        active_point_size: 10,
        width: 960,
        height: 150,
        right: 1,
        target: '#ask_moduladaASK',
        x_accessor: 'Tiempo',
        y_accessor: 'Modulada',
        x_label: 'Tiempo',
        y_label: 'Modulada',
        y_extended_ticks: true,
        x_extended_ticks: true,
        animate_on_load: true,
        area: false
    };
    var varMDPDASK = {
        custom_line_color_map: [8, 9],
        inflator: 1.6,
        missing_is_hidden: true,
        point_size: 4.5,
        active_point_on_lines: true,
        top: 10,
        active_point_size: 10,
        width: 960,
        height: 170,
        right: 1,
        target: '#ask_moduladaASKMix',
        x_accessor: 'Tiempo',
        y_accessor: 'Valor',
        x_label: 'Tiempo',
        y_label: 'Moduladora/Portadora',
        y_extended_ticks: true,
        x_extended_ticks: true,
        animate_on_load: true,
        area: false,
        legend: ['Moduladora', 'Portadora'],
        legend_target: '#legendMix'
    };


    var Ec_txt_ASK = $("#amp_ask_p");
    var fc_txt_ASK = $("#freq_ask");
    var Em_txt_ASK = $("#amp_ask_m");
    var fb_txt_ASK = $("#freq_ask_m");

    (function () {
        dibujar(false, Ec_txt_ASK.val(), fc_txt_ASK.val(), Em_txt_ASK.val(), fb_txt_ASK.val());
    })();

    $('#askRedraw ').click(function () {
        $("#askRedrawIcon").removeClass().addClass('fa fa-refresh fa-spin');
        loading();
        setTimeout(function () {
            dibujar(false, Ec_txt_ASK.val(), fc_txt_ASK.val(), Em_txt_ASK.val(), fb_txt_ASK.val())
        }, 10);
    });


    function dibujar(redibujar, amp_ask_p, freq_ask, amp_ask_m, freq_ask_m) {
        dwASKEnd = 0;
        let TiempoMin = 0;
        let TiempoMax = 720;
        let portadora = 0;
        let moduladora = 0;
        let moduladaASK = 0;
        let dataAKS = [];
        let dataAKSPortadora = [];
        let dataAKSModuladora = [];

        let Tiempo;
        for (Tiempo = TiempoMin; Tiempo <= TiempoMax; Tiempo++) {
            portadora = (amp_ask_p) * (SIN(RADIANS(Tiempo * freq_ask)));
            moduladora = (amp_ask_m) * (SIN(RADIANS(freq_ask_m * Tiempo))) > 0 ? 1 : 0;
            moduladaASK = portadora * moduladora;
            //console.log("valores: " + Tiempo + "  " + portadora + "  " + moduladora + "  " + moduladaASK);
            dataAKS.push({
                "Tiempo": Tiempo,
                "Portadora": portadora,
                "Moduladora": moduladora,
                "Modulada": moduladaASK
            });
            dataAKSModuladora.push({
                "Tiempo": Tiempo,
                "Valor": moduladora
            });
            dataAKSPortadora.push({
                "Tiempo": Tiempo,
                "Valor": portadora
            });
        }
        delete dwPortadoraASK.data;
        delete dwModuladoraASK.data;
        delete dwModuladaASK.data;
        delete varMDPDASK.data;
        dwPortadoraASK.data = dataAKS;
        dwModuladoraASK.data = dataAKS;
        dwModuladaASK.data = dataAKS;
        varMDPDASK.data = [dataAKSPortadora, dataAKSModuladora];
        MG.data_graphic(dwPortadoraASK);
        MG.data_graphic(dwModuladoraASK);
        MG.data_graphic(dwModuladaASK);
        MG.data_graphic(varMDPDASK);

        d3.select("#ask_moduladora").transition().on("end", function () {
            dwASKEnd = +1;
            completo();
        });
        d3.select("#ask_portadora").transition().on("end", function () {
            dwASKEnd = +1;
            completo();
        });
        d3.select("#ask_moduladaASK").transition().on("end", function () {
            dwASKEnd = +1;
            completo();
        });
        d3.select("#ask_moduladaASKMix").transition().on("end", function () {
            dwASKEnd = +1;
            completo();
        });
    }
</script>
